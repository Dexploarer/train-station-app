import{a as I,r as l,j as e,A as y,p as D,Z as F,f as G,h as u}from"./index-FKmzij_1.js";import{u as U}from"./useCRM-D8N1rZSr.js";import{u as V,B as H}from"./Breadcrumbs-CCWRCGTu.js";import{u as W}from"./useLoyaltyProgram-BJKawQSX.js";import{C as Z}from"./credit-card-DFedzW3U.js";import{S as q}from"./star-BWMOOjAP.js";import{C as v}from"./clock-C-ss61e7.js";import{U as w}from"./user-plus-CfM5jUa9.js";import{G as O}from"./gift-CdYB-dbO.js";import{f as z}from"./format-CWC1h8aK.js";import"./useMutation-Chvc8RUs.js";import"./chevron-right-uU2N22sE.js";const le=()=>{const p=I(),C=V(),{customers:b,isLoading:P}=U(),{loyaltyTiers:x,pointsMultipliers:k,customerLoyalty:d,isLoadingLoyalty:M,updateCustomerPoints:A}=W(),[n,L]=l.useState(""),[m,R]=l.useState(null),[S,o]=l.useState(!1),[r,T]=l.useState(null),[c,f]=l.useState(0),[h,g]=l.useState(""),j=b.filter(s=>{if(!(`${s.firstName} ${s.lastName}`.toLowerCase().includes(n.toLowerCase())||s.email&&s.email.toLowerCase().includes(n.toLowerCase())||s.tags&&s.tags.some(i=>i.toLowerCase().includes(n.toLowerCase()))))return!1;if(!m)return!0;const a=d.find(i=>i.customerId===s.id);return(a==null?void 0:a.tierId)===m}),N=s=>{const t=d.find(i=>i.customerId===s);if(!t)return{points:0,tier:null,tierName:"None"};const a=x.find(i=>i.id===t.tierId);return{points:t.points,tier:a,tierName:(a==null?void 0:a.name)||"None"}},B=async()=>{if(!r||c<=0||!h){u.error("Please fill in all required fields");return}try{await A(r.id,c,h),o(!1),f(0),g(""),u.success(`Added ${c} points to ${r.firstName} ${r.lastName}`)}catch(s){console.error("Error adding points:",s),u.error("Failed to add points")}};return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx(H,{items:C}),e.jsxs("div",{className:"flex flex-col justify-between space-y-3 sm:flex-row sm:items-center sm:space-y-0",children:[e.jsx("h1",{className:"font-playfair text-2xl sm:text-3xl font-bold tracking-tight text-white",children:"Loyalty Program"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{className:"inline-flex items-center rounded-lg bg-zinc-800 px-3 py-2 text-sm font-medium text-white hover:bg-zinc-700 focus:outline-none",children:[e.jsx(Z,{size:16,className:"mr-2"}),"Rewards"]}),e.jsxs("button",{className:"inline-flex items-center rounded-lg bg-amber-600 px-3 py-2 text-sm font-medium text-white hover:bg-amber-700 focus:outline-none",children:[e.jsx(y,{size:16,className:"mr-2"}),"Manage Tiers"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:x.map((s,t)=>e.jsxs("div",{className:`rounded-lg p-4 ${t===0?"bg-zinc-900":t===1?"bg-gradient-to-br from-amber-900 to-amber-800":"bg-gradient-to-br from-slate-900 to-slate-800"}`,children:[e.jsxs("div",{className:"mb-2 flex items-center",children:[e.jsx("div",{className:`rounded-full p-2 ${t===0?"bg-zinc-800":t===1?"bg-amber-700":"bg-slate-700"}`,children:t===0?e.jsx(D,{size:16,className:"text-gray-300"}):t===1?e.jsx(y,{size:16,className:"text-amber-300"}):e.jsx(q,{size:16,className:"text-blue-300"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-base font-medium text-white",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-300",children:[s.pointThreshold,"+ points"]})]})]}),e.jsx("div",{className:"mt-2 space-y-2 text-sm",children:s.benefits.split(",").map((a,i)=>e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"mr-2 mt-0.5",children:e.jsx("svg",{className:"h-3 w-3 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("span",{className:"text-gray-300",children:a.trim()})]},i))})]},s.id))}),e.jsxs("div",{className:"rounded-lg bg-zinc-900 p-4 sm:p-6",children:[e.jsx("h2",{className:"mb-4 text-lg sm:text-xl font-semibold text-white",children:"Point Multipliers"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4",children:k.map((s,t)=>e.jsxs("div",{className:"rounded-lg bg-zinc-800 p-3",children:[e.jsxs("div",{className:"mb-2",children:[e.jsxs("span",{className:"rounded-full bg-amber-600 px-2 py-0.5 text-xs font-medium text-white",children:[s.multiplier,"x"]}),e.jsx("h3",{className:"mt-1 font-medium text-white",children:s.name})]}),e.jsx("p",{className:"text-xs text-gray-400",children:s.description})]},t))}),e.jsx("div",{className:"mt-4 p-3 bg-zinc-800 rounded-lg",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(F,{size:16,className:"mr-2 text-amber-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-white",children:"How Points Work"}),e.jsx("p",{className:"mt-1 text-xs text-gray-300",children:"Customers earn points for purchases, attending events, and more. Points accumulate to unlock tier benefits and can be redeemed for rewards. Higher tiers provide better rewards and exclusive benefits."})]})]})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-3 sm:mb-4 flex flex-col sm:flex-row items-start sm:items-center justify-between space-y-2 sm:space-y-0",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-white",children:"Customers"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx(G,{size:12,className:"text-gray-400"})}),e.jsx("input",{type:"text",className:"block w-full rounded-lg border-0 bg-zinc-800 py-1.5 pl-8 pr-3 text-white placeholder-gray-400 focus:ring-2 focus:ring-amber-500 text-xs sm:text-sm",placeholder:"Search customers...",value:n,onChange:s=>L(s.target.value)})]}),e.jsxs("select",{value:m||"",onChange:s=>R(s.target.value||null),className:"rounded-lg border-0 bg-zinc-800 py-1.5 pl-3 pr-8 text-white focus:ring-2 focus:ring-amber-500 text-xs sm:text-sm",children:[e.jsx("option",{value:"",children:"All Tiers"}),x.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]})]}),P||M?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"mr-2 h-5 w-5 animate-spin rounded-full border-2 border-gray-300 border-t-amber-600"}),e.jsx("p",{className:"text-white",children:"Loading customers..."})]}):j.length>0?e.jsx("div",{className:"overflow-x-auto rounded-lg border border-zinc-800",children:e.jsxs("table",{className:"min-w-full divide-y divide-zinc-800",children:[e.jsx("thead",{className:"bg-zinc-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-400",children:"Customer"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-400",children:"Tier"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-400",children:"Points"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-400",children:"Last Visit"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-400",children:"Tags"}),e.jsx("th",{className:"relative px-4 py-3"})]})}),e.jsx("tbody",{className:"divide-y divide-zinc-800 bg-zinc-900",children:j.map(s=>{const{points:t,tier:a,tierName:i}=N(s.id);return e.jsxs("tr",{className:"hover:bg-zinc-800",children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"h-8 w-8 rounded-full bg-amber-700 flex items-center justify-center text-xs font-medium text-white",children:[s.firstName[0],s.lastName[0]]}),e.jsxs("div",{className:"ml-3",children:[e.jsxs("div",{className:"text-sm font-medium text-white",children:[s.firstName," ",s.lastName]}),e.jsx("div",{className:"text-xs text-gray-400",children:s.email})]})]})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium
                          ${i==="Gold"?"bg-amber-100 text-amber-800":i==="Platinum"?"bg-slate-100 text-slate-800":"bg-zinc-100 text-zinc-800"}`,children:i})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-white",children:t}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center text-sm text-gray-300",children:[e.jsx(v,{size:12,className:"mr-1 text-gray-400"}),s.lastVisit?z(new Date(s.lastVisit),"MMM d, yyyy"):"Never"]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.tags.slice(0,2).map(($,E)=>e.jsx("span",{className:"inline-flex items-center rounded-full bg-zinc-800 px-2 py-0.5 text-xs text-gray-300",children:$},E)),s.tags.length>2&&e.jsxs("span",{className:"inline-flex items-center rounded-full bg-zinc-800 px-2 py-0.5 text-xs text-gray-500",children:["+",s.tags.length-2]})]})}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>{T(s),o(!0)},className:"text-amber-500 hover:text-amber-400 mr-3",children:"Add Points"}),e.jsx("button",{onClick:()=>p(`/customers/${s.id}`),className:"text-gray-400 hover:text-white",children:"Details"})]})]},s.id)})})]})}):e.jsxs("div",{className:"rounded-lg bg-zinc-900 p-6 text-center",children:[e.jsx(w,{size:32,className:"mx-auto text-amber-500 opacity-50"}),e.jsx("h2",{className:"mt-4 text-xl font-semibold text-white",children:"No customers found"}),e.jsx("p",{className:"mt-1 text-gray-400",children:n||m?"No customers match your filter criteria.":"Add customers to enroll them in the loyalty program."}),e.jsxs("button",{onClick:()=>p("/customers"),className:"mt-4 inline-flex items-center rounded-lg bg-amber-600 px-4 py-2 text-sm font-medium text-white hover:bg-amber-700",children:[e.jsx(w,{size:14,className:"mr-2"}),"Manage Customers"]})]}),d.length>0&&e.jsxs("div",{className:"mt-6 rounded-lg bg-zinc-900 p-4 sm:p-6",children:[e.jsx("h2",{className:"mb-3 text-lg font-semibold text-white",children:"Recent Activity"}),e.jsx("div",{className:"space-y-3",children:d.slice(0,5).sort((s,t)=>new Date(t.lastUpdated).getTime()-new Date(s.lastUpdated).getTime()).map((s,t)=>{const a=b.find(i=>i.id===s.customerId);return a?e.jsx("div",{className:"rounded-lg bg-zinc-800 p-3",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"mr-3 h-8 w-8 rounded-full bg-amber-700 flex items-center justify-center text-xs font-medium text-white",children:[a.firstName[0],a.lastName[0]]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-white",children:[a.firstName," ",a.lastName]}),e.jsxs("div",{className:"flex items-center text-xs text-gray-400",children:[e.jsx(v,{size:10,className:"mr-1"}),z(new Date(s.lastUpdated),"MMM d, yyyy")]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-medium text-white",children:[s.lastPointsAdded," points"]}),e.jsx("div",{className:"text-xs text-gray-400",children:s.lastPointsReason})]})]})},t):null})})]})]}),e.jsxs("div",{className:"rounded-lg bg-zinc-900 p-4 sm:p-6",children:[e.jsxs("h2",{className:"mb-4 text-lg sm:text-xl font-semibold text-white flex items-center",children:[e.jsx(O,{size:18,className:"mr-2 text-amber-500"}),"Available Rewards"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"rounded-lg bg-gradient-to-br from-zinc-800 to-zinc-900 p-4 border border-zinc-700",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("span",{className:"rounded-full bg-amber-100 px-2.5 py-0.5 text-xs font-medium text-amber-800",children:"Regular"}),e.jsx("span",{className:"text-sm font-medium text-white",children:"500 points"})]}),e.jsx("h3",{className:"text-base font-medium text-white",children:"Free Drink Voucher"}),e.jsx("p",{className:"mb-3 mt-1 text-sm text-gray-300",children:"Redeem for one free standard drink at the venue bar."}),e.jsx("button",{className:"w-full rounded-lg bg-amber-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-amber-700",children:"Redeem"})]}),e.jsxs("div",{className:"rounded-lg bg-gradient-to-br from-zinc-800 to-zinc-900 p-4 border border-zinc-700",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("span",{className:"rounded-full bg-amber-100 px-2.5 py-0.5 text-xs font-medium text-amber-800",children:"Gold"}),e.jsx("span",{className:"text-sm font-medium text-white",children:"1000 points"})]}),e.jsx("h3",{className:"text-base font-medium text-white",children:"Free Admission"}),e.jsx("p",{className:"mb-3 mt-1 text-sm text-gray-300",children:"One free entry to a standard event (excludes special events)."}),e.jsx("button",{className:"w-full rounded-lg bg-amber-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-amber-700",children:"Redeem"})]}),e.jsxs("div",{className:"rounded-lg bg-gradient-to-br from-zinc-800 to-zinc-900 p-4 border border-zinc-700",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("span",{className:"rounded-full bg-blue-100 px-2.5 py-0.5 text-xs font-medium text-blue-800",children:"Platinum"}),e.jsx("span",{className:"text-sm font-medium text-white",children:"2500 points"})]}),e.jsx("h3",{className:"text-base font-medium text-white",children:"VIP Experience"}),e.jsx("p",{className:"mb-3 mt-1 text-sm text-gray-300",children:"VIP treatment for one event including reserved seating and a drink package."}),e.jsx("button",{className:"w-full rounded-lg bg-blue-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-blue-700",children:"Redeem"})]}),e.jsxs("div",{className:"rounded-lg bg-gradient-to-br from-zinc-800 to-zinc-900 p-4 border border-zinc-700",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("span",{className:"rounded-full bg-amber-100 px-2.5 py-0.5 text-xs font-medium text-amber-800",children:"Regular"}),e.jsx("span",{className:"text-sm font-medium text-white",children:"750 points"})]}),e.jsx("h3",{className:"text-base font-medium text-white",children:"Merchandise Credit"}),e.jsx("p",{className:"mb-3 mt-1 text-sm text-gray-300",children:"$15 credit toward venue merchandise."}),e.jsx("button",{className:"w-full rounded-lg bg-amber-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-amber-700",children:"Redeem"})]}),e.jsxs("div",{className:"rounded-lg bg-gradient-to-br from-zinc-800 to-zinc-900 p-4 border border-zinc-700",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("span",{className:"rounded-full bg-amber-100 px-2.5 py-0.5 text-xs font-medium text-amber-800",children:"Gold"}),e.jsx("span",{className:"text-sm font-medium text-white",children:"1500 points"})]}),e.jsx("h3",{className:"text-base font-medium text-white",children:"Event Pre-sale Access"}),e.jsx("p",{className:"mb-3 mt-1 text-sm text-gray-300",children:"Early access to tickets for the next 3 special events."}),e.jsx("button",{className:"w-full rounded-lg bg-amber-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-amber-700",children:"Redeem"})]}),e.jsxs("div",{className:"rounded-lg bg-gradient-to-br from-zinc-800 to-zinc-900 p-4 border border-zinc-700",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("span",{className:"rounded-full bg-blue-100 px-2.5 py-0.5 text-xs font-medium text-blue-800",children:"Platinum"}),e.jsx("span",{className:"text-sm font-medium text-white",children:"5000 points"})]}),e.jsx("h3",{className:"text-base font-medium text-white",children:"Meet & Greet Pass"}),e.jsx("p",{className:"mb-3 mt-1 text-sm text-gray-300",children:"Meet and greet with an artist at an upcoming event."}),e.jsx("button",{className:"w-full rounded-lg bg-blue-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-blue-700",children:"Redeem"})]})]})]}),S&&r&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",children:e.jsxs("div",{className:"max-w-md rounded-lg bg-zinc-900 p-6 shadow-xl w-full",children:[e.jsx("h2",{className:"mb-4 text-xl font-semibold text-white",children:"Add Loyalty Points"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Customer"}),e.jsxs("div",{className:"mt-1 flex items-center",children:[e.jsxs("div",{className:"mr-3 h-8 w-8 rounded-full bg-amber-700 flex items-center justify-center text-xs font-medium text-white",children:[r.firstName[0],r.lastName[0]]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-white",children:[r.firstName," ",r.lastName]}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Current: ",N(r.id).points," points"]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"points",className:"block text-sm font-medium text-gray-300",children:"Points to Add"}),e.jsx("input",{type:"number",id:"points",value:c,onChange:s=>f(Math.max(0,parseInt(s.target.value)||0)),min:"0",className:"mt-1 block w-full rounded-md border border-zinc-700 bg-zinc-800 px-3 py-2 text-white focus:border-amber-500 focus:outline-none focus:ring-amber-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-gray-300",children:"Reason"}),e.jsxs("select",{id:"reason",value:h,onChange:s=>g(s.target.value),className:"mt-1 block w-full rounded-md border border-zinc-700 bg-zinc-800 px-3 py-2 text-white focus:border-amber-500 focus:outline-none focus:ring-amber-500",children:[e.jsx("option",{value:"",children:"Select reason..."}),e.jsx("option",{value:"Event Attendance",children:"Event Attendance"}),e.jsx("option",{value:"Bar Purchase",children:"Bar Purchase"}),e.jsx("option",{value:"Merchandise Purchase",children:"Merchandise Purchase"}),e.jsx("option",{value:"Referral",children:"Customer Referral"}),e.jsx("option",{value:"Special Promotion",children:"Special Promotion"}),e.jsx("option",{value:"Birthday Bonus",children:"Birthday Bonus"})]})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>o(!1),className:"rounded-lg bg-zinc-800 px-4 py-2 text-sm font-medium text-white hover:bg-zinc-700",children:"Cancel"}),e.jsx("button",{type:"button",onClick:B,className:"rounded-lg bg-amber-600 px-4 py-2 text-sm font-medium text-white hover:bg-amber-700",children:"Add Points"})]})]})})]})};export{le as default};
