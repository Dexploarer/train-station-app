import{c as D,s as B,G as k,h as f,r as b,j as e,L as C,n as $,p as M,H as se,C as K,X as O,I as te,l as ie,a as ne,o as ae,f as re}from"./index-FKmzij_1.js";import{u as le,B as ce}from"./Breadcrumbs-CCWRCGTu.js";import{a as oe}from"./useEvents-DWrrskT-.js";import{u as P,a as Q}from"./useMutation-Chvc8RUs.js";import{S as R}from"./star-BWMOOjAP.js";import{f as de}from"./format-CWC1h8aK.js";import{B as H}from"./bar-chart-C0SHvXzr.js";import{P as _}from"./plus-KKCTwYn-.js";import{S as me}from"./save-DrKIf50q.js";import{A as xe}from"./alert-circle-CsAWtVep.js";import{T as ue,a as he,b as S,c as q}from"./tabs-CcZ13cWJ.js";import{C as pe}from"./chevron-left-BZb8Pfj0.js";import{M as be}from"./message-square-Df_PiQnb.js";import"./chevron-right-uU2N22sE.js";import"./validation-Bq8tbDJB.js";import"./types-D9u2zvev.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=D("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z",key:"s6e0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=D("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);function I(a){const d=B(),u=P({queryKey:["event_reviews",a],queryFn:()=>k.getEventReviews(a)}),c=Q({mutationFn:({review:i,responses:r})=>k.createEventReview(i,r),onSuccess:()=>{d.invalidateQueries({queryKey:["event_reviews"]}),a&&d.invalidateQueries({queryKey:["event_reviews",a]}),f.success("Review submitted successfully!")},onError:i=>{f.error(`Error submitting review: ${i.message}`)}}),m=Q({mutationFn:({id:i,updates:r})=>k.updateEventReview(i,r),onSuccess:()=>{d.invalidateQueries({queryKey:["event_reviews"]}),a&&d.invalidateQueries({queryKey:["event_reviews",a]}),f.success("Review updated successfully!")},onError:i=>{f.error(`Error updating review: ${i.message}`)}}),s=Q({mutationFn:i=>k.deleteEventReview(i),onSuccess:()=>{d.invalidateQueries({queryKey:["event_reviews"]}),a&&d.invalidateQueries({queryKey:["event_reviews",a]}),f.success("Review deleted successfully!")},onError:i=>{f.error(`Error deleting review: ${i.message}`)}});return{reviews:u.data||[],isLoading:u.isLoading,isError:u.isError,error:u.error,createReview:c.mutate,updateReview:m.mutate,deleteReview:s.mutate,isCreating:c.isPending,isUpdating:m.isPending,isDeleting:s.isPending}}function V(){const a=B(),d=P({queryKey:["feedback_questions"],queryFn:k.getFeedbackQuestions}),u=Q({mutationFn:c=>k.createFeedbackQuestion(c),onSuccess:()=>{a.invalidateQueries({queryKey:["feedback_questions"]}),f.success("Question added successfully!")},onError:c=>{f.error(`Error adding question: ${c.message}`)}});return{questions:d.data||[],isLoading:d.isLoading,isError:d.isError,error:d.error,createQuestion:u.mutate,isCreating:u.isPending}}const fe=({eventId:a,onSuccess:d,customerId:u})=>{const{createReview:c,isCreating:m}=I(a),{questions:s,isLoading:i}=V(),[r,h]=b.useState(0),[p,w]=b.useState(0),[v,y]=b.useState(""),[t,n]=b.useState({}),[g,N]=b.useState([]),[z,T]=b.useState("rating"),Z=["Sound Quality","Staff","Venue","Value","Drinks","Atmosphere","Accessibility","Seating"],G=l=>{g.includes(l)?N(g.filter(o=>o!==l)):N([...g,l])},W=l=>{h(l)},F=l=>{w(l)},E=(l,o)=>{n(x=>({...x,[l]:o}))},L=async()=>{if(r===0){f.error("Please provide a rating");return}try{const l={eventId:a,customerId:u||null,rating:r,reviewText:v||null,attendanceConfirmed:!0,reviewDate:new Date().toISOString(),sentiment:r>=4?"positive":r<=2?"negative":"neutral",tags:g},o=[];s&&s.length>0&&s.forEach(x=>{if(t[x.id]!==void 0){let j={questionId:x.id,responseText:null,responseRating:null,responseOption:null};switch(x.questionType){case"rating":j.responseRating=t[x.id];break;case"text":j.responseText=t[x.id];break;case"multiple_choice":j.responseOption=t[x.id];break}o.push(j)}}),await c({review:l,responses:o}),h(0),y(""),n({}),N([]),T("rating"),d&&d()}catch(l){console.error("Error submitting review:",l)}},A=()=>s.filter(l=>l.active),X=()=>e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:`h-2 w-8 rounded-full ${z==="rating"?"bg-amber-500":"bg-zinc-700"}`}),e.jsx("div",{className:`h-2 w-8 rounded-full ${z==="review"?"bg-amber-500":"bg-zinc-700"}`}),e.jsx("div",{className:`h-2 w-8 rounded-full ${z==="questions"?"bg-amber-500":"bg-zinc-700"}`})]})}),Y=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"How would you rate your experience?"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Tap a star to rate"})]}),e.jsx("div",{className:"flex justify-center space-x-2",children:[1,2,3,4,5].map(l=>e.jsx("button",{type:"button",onClick:()=>W(l),onMouseEnter:()=>F(l),onMouseLeave:()=>F(0),className:"p-1 focus:outline-none",children:e.jsx(R,{size:32,className:`${(p||r)>=l?"text-amber-400 fill-amber-400":"text-zinc-600"}`})},l))}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{type:"button",onClick:()=>T("review"),disabled:r===0,className:"inline-flex items-center rounded-lg bg-amber-600 px-4 py-2 text-sm font-medium text-white hover:bg-amber-700 focus:outline-none disabled:opacity-50",children:"Next"})})]}),J=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reviewText",className:"block text-sm font-medium text-gray-300",children:"Share your thoughts about the event"}),e.jsx("textarea",{id:"reviewText",value:v,onChange:l=>y(l.target.value),rows:4,className:"mt-1 block w-full rounded-md border border-zinc-700 bg-zinc-800 px-3 py-2 text-white placeholder-gray-400 focus:border-amber-500 focus:outline-none focus:ring-amber-500",placeholder:"Tell us about your experience..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"What aspects would you like to highlight?"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Z.map(l=>e.jsx("button",{type:"button",onClick:()=>G(l),className:`rounded-full px-3 py-1 text-xs font-medium ${g.includes(l)?"bg-amber-600 text-white":"bg-zinc-800 text-gray-300 hover:bg-zinc-700"}`,children:l},l))})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{type:"button",onClick:()=>T("rating"),className:"inline-flex items-center rounded-lg bg-zinc-700 px-4 py-2 text-sm font-medium text-white hover:bg-zinc-600 focus:outline-none",children:"Back"}),i||A().length>0?e.jsx("button",{type:"button",onClick:()=>T("questions"),className:"inline-flex items-center rounded-lg bg-amber-600 px-4 py-2 text-sm font-medium text-white hover:bg-amber-700 focus:outline-none",children:"Next"}):e.jsx("button",{type:"button",onClick:L,disabled:m,className:"inline-flex items-center rounded-lg bg-amber-600 px-4 py-2 text-sm font-medium text-white hover:bg-amber-700 focus:outline-none disabled:opacity-50",children:m?e.jsxs(e.Fragment,{children:[e.jsx(C,{size:16,className:"mr-2 animate-spin"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx($,{size:16,className:"mr-2"}),"Submit Review"]})})]})]}),ee=()=>{if(i)return e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(C,{size:24,className:"animate-spin text-amber-500"})});const l=A();return l.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-400",children:"No additional questions available"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Additional Feedback"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Please answer a few more questions"})]}),e.jsx("div",{className:"space-y-6",children:l.map(o=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300",children:[o.questionText," ",o.isRequired&&e.jsx("span",{className:"text-red-500",children:"*"})]}),o.questionType==="rating"&&e.jsx("div",{className:"flex space-x-2",children:[1,2,3,4,5].map(x=>e.jsx("button",{type:"button",onClick:()=>E(o.id,x),className:"p-1 focus:outline-none",children:e.jsx(R,{size:24,className:`${(t[o.id]||0)>=x?"text-amber-400 fill-amber-400":"text-zinc-600"}`})},x))}),o.questionType==="text"&&e.jsx("textarea",{value:t[o.id]||"",onChange:x=>E(o.id,x.target.value),rows:3,className:"mt-1 block w-full rounded-md border border-zinc-700 bg-zinc-800 px-3 py-2 text-white placeholder-gray-400 focus:border-amber-500 focus:outline-none focus:ring-amber-500",placeholder:"Your answer...",required:o.isRequired}),o.questionType==="multiple_choice"&&e.jsx("div",{className:"space-y-2",children:o.options.map((x,j)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:`${o.id}-option-${j}`,type:"radio",value:x,checked:t[o.id]===x,onChange:()=>E(o.id,x),className:"h-4 w-4 border-zinc-600 bg-zinc-800 text-amber-600 focus:ring-amber-600",required:o.isRequired}),e.jsx("label",{htmlFor:`${o.id}-option-${j}`,className:"ml-2 text-sm text-gray-300",children:x})]},j))})]},o.id))}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{type:"button",onClick:()=>T("review"),className:"inline-flex items-center rounded-lg bg-zinc-700 px-4 py-2 text-sm font-medium text-white hover:bg-zinc-600 focus:outline-none",children:"Back"}),e.jsx("button",{type:"button",onClick:L,disabled:m||l.some(o=>o.isRequired&&!t[o.id]),className:"inline-flex items-center rounded-lg bg-amber-600 px-4 py-2 text-sm font-medium text-white hover:bg-amber-700 focus:outline-none disabled:opacity-50",children:m?e.jsxs(e.Fragment,{children:[e.jsx(C,{size:16,className:"mr-2 animate-spin"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx($,{size:16,className:"mr-2"}),"Submit Review"]})})]})]})};return e.jsxs("div",{className:"rounded-lg bg-zinc-900 p-4 sm:p-6",children:[X(),z==="rating"&&Y(),z==="review"&&J(),z==="questions"&&ee()]})},je=({reviews:a,isLoading:d,onSelect:u})=>{if(d)return e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-2 border-amber-500 border-t-transparent"}),e.jsx("span",{className:"ml-2 text-white",children:"Loading reviews..."})]});if(!a||a.length===0)return e.jsxs("div",{className:"rounded-lg bg-zinc-800 p-6 text-center",children:[e.jsx("p",{className:"text-gray-300",children:"No reviews yet"}),e.jsx("p",{className:"mt-1 text-sm text-gray-400",children:"Be the first to leave a review!"})]});const c=s=>e.jsxs("div",{className:"flex items-center",children:[[1,2,3,4,5].map(i=>e.jsx(R,{size:16,className:`${s>=i?"fill-amber-400 text-amber-400":"text-zinc-600"}`},i)),e.jsx("span",{className:"ml-2 text-white",children:s.toFixed(1)})]}),m=s=>{if(!s)return null;switch(s){case"positive":return e.jsx(U,{size:14,className:"text-green-500"});case"negative":return e.jsx(ge,{size:14,className:"text-red-500"});default:return null}};return e.jsx("div",{className:"space-y-4",children:a.map(s=>e.jsxs("div",{className:"rounded-lg bg-zinc-800 p-4 hover:bg-zinc-700 cursor-pointer",onClick:()=>u&&u(s),children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"space-y-1",children:[c(s.rating),s.reviewText&&e.jsx("p",{className:"text-gray-300 mt-2",children:s.reviewText}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:s.tags.map((i,r)=>e.jsx("span",{className:"rounded-full bg-zinc-700 px-2 py-0.5 text-xs text-gray-300",children:i},r))})]}),s.sentiment&&e.jsx("div",{className:"flex items-center",children:m(s.sentiment)})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between border-t border-zinc-700 pt-2 text-xs text-gray-400",children:[e.jsxs("div",{className:"flex items-center",children:[s.customerName?e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{size:12,className:"mr-1"}),e.jsx("span",{children:s.customerName})]}):e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{size:12,className:"mr-1"}),e.jsx("span",{children:"Anonymous"})]}),s.attendanceConfirmed&&e.jsxs("div",{className:"ml-3 flex items-center text-green-500",children:[e.jsx(se,{size:12,className:"mr-1"}),e.jsx("span",{children:"Verified Attendee"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(K,{size:12,className:"mr-1"}),e.jsx("span",{children:de(new Date(s.reviewDate),"MMM d, yyyy")})]})]})]},s.id))})},ve=({reviews:a,isLoading:d})=>{const c=(()=>{if(!a||a.length===0)return{average:0,count:0,distribution:{1:0,2:0,3:0,4:0,5:0},tags:{}};const s=a.reduce((h,p)=>h+p.rating,0),i={1:0,2:0,3:0,4:0,5:0};a.forEach(h=>{i[h.rating]=(i[h.rating]||0)+1});const r={};return a.forEach(h=>{h.tags.forEach(p=>{r[p]=(r[p]||0)+1})}),{average:s/a.length,count:a.length,distribution:i,tags:r}})();if(d)return e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-2 border-amber-500 border-t-transparent"}),e.jsx("span",{className:"ml-2 text-white",children:"Loading reviews..."})]});const m=Object.entries(c.tags).sort((s,i)=>i[1]-s[1]).slice(0,5);return e.jsxs("div",{className:"rounded-lg bg-zinc-900 p-4 sm:p-6",children:[e.jsx("h3",{className:"mb-4 text-lg font-medium text-white",children:"Reviews Overview"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"rounded-lg bg-zinc-800 p-4 text-center",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Average Rating"}),e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(R,{size:20,className:"text-amber-400 fill-amber-400 mr-1"}),e.jsx("span",{className:"text-2xl font-bold text-white",children:c.count>0?c.average.toFixed(1):"-"}),e.jsx("span",{className:"text-sm text-gray-400 ml-1",children:"/ 5"})]})]}),e.jsxs("div",{className:"rounded-lg bg-zinc-800 p-4 text-center",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Total Reviews"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:c.count})]}),e.jsxs("div",{className:"rounded-lg bg-zinc-800 p-4 text-center",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Recommendation Rate"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:c.count>0?`${Math.round(((c.distribution[4]||0)+(c.distribution[5]||0))/c.count*100)}%`:"-"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"mb-3 text-sm font-medium text-white flex items-center",children:[e.jsx(H,{size:16,className:"mr-2 text-amber-500"}),"Rating Distribution"]}),e.jsx("div",{className:"space-y-2",children:[5,4,3,2,1].map(s=>{const i=c.distribution[s]||0,r=c.count>0?i/c.count*100:0;return e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"w-12 text-gray-300 text-sm",children:[s," star"]}),e.jsx("div",{className:"flex-1 mx-2",children:e.jsx("div",{className:"h-2 w-full bg-zinc-700 rounded-full",children:e.jsx("div",{className:`h-2 rounded-full ${s>=4?"bg-green-500":s===3?"bg-amber-500":"bg-red-500"}`,style:{width:`${r}%`}})})}),e.jsxs("div",{className:"w-12 text-right",children:[e.jsx("span",{className:"text-xs text-gray-300",children:i}),e.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(",r.toFixed(0),"%)"]})]})]},s)})})]}),m.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"mb-3 text-sm font-medium text-white",children:"Most Mentioned"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:m.map(([s,i])=>e.jsxs("div",{className:"rounded-full bg-zinc-800 px-3 py-1 text-xs",children:[e.jsx("span",{className:"text-gray-300",children:s}),e.jsxs("span",{className:"ml-1 text-amber-500",children:["(",i,")"]})]},s))})]})]})},ye=()=>{const{questions:a,isLoading:d,createQuestion:u,isCreating:c}=V(),[m,s]=b.useState(!1),[i,r]=b.useState({questionText:"",questionType:"rating",options:[],isRequired:!0,active:!0,displayOrder:0}),[h,p]=b.useState(""),w=()=>{h.trim()&&(r(t=>({...t,options:[...t.options,h.trim()]})),p(""))},v=t=>{r(n=>({...n,options:n.options.filter((g,N)=>N!==t)}))},y=async()=>{try{if(!i.questionText){f.error("Question text is required");return}if(i.questionType==="multiple_choice"&&i.options.length===0){f.error("Please add at least one option for multiple choice questions");return}const t=a.length>0?Math.max(...a.map(n=>n.displayOrder)):-1;await u({...i,displayOrder:t+1}),r({questionText:"",questionType:"rating",options:[],isRequired:!0,active:!0,displayOrder:0}),s(!1)}catch(t){console.error("Error adding question:",t)}};return e.jsxs("div",{className:"rounded-lg bg-zinc-900 p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Feedback Questions"}),!m&&e.jsxs("button",{type:"button",onClick:()=>s(!0),className:"inline-flex items-center rounded-lg bg-amber-600 px-3 py-1.5 text-xs sm:text-sm font-medium text-white hover:bg-amber-700",children:[e.jsx(_,{size:16,className:"mr-2"}),"Add Question"]})]}),m&&e.jsxs("div",{className:"mb-6 rounded-lg bg-zinc-800 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-medium text-white",children:"New Feedback Question"}),e.jsx("button",{type:"button",onClick:()=>s(!1),className:"rounded-full bg-zinc-700 p-1 text-gray-300 hover:text-white",children:e.jsx(O,{size:16})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"questionText",className:"block text-sm font-medium text-gray-300",children:["Question Text ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"questionText",value:i.questionText,onChange:t=>r(n=>({...n,questionText:t.target.value})),className:"mt-1 block w-full rounded-md border border-zinc-700 bg-zinc-700 px-3 py-2 text-white placeholder-gray-400 focus:border-amber-500 focus:outline-none focus:ring-amber-500",placeholder:"e.g. How satisfied were you with the sound quality?"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"questionType",className:"block text-sm font-medium text-gray-300",children:"Question Type"}),e.jsxs("select",{id:"questionType",value:i.questionType,onChange:t=>r(n=>({...n,questionType:t.target.value,options:t.target.value!=="multiple_choice"?[]:n.options})),className:"mt-1 block w-full rounded-md border border-zinc-700 bg-zinc-700 px-3 py-2 text-white focus:border-amber-500 focus:outline-none focus:ring-amber-500",children:[e.jsx("option",{value:"rating",children:"Star Rating"}),e.jsx("option",{value:"text",children:"Text Comment"}),e.jsx("option",{value:"multiple_choice",children:"Multiple Choice"})]})]}),i.questionType==="multiple_choice"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Options"}),e.jsxs("div",{className:"mt-1 flex",children:[e.jsx("input",{type:"text",value:h,onChange:t=>p(t.target.value),className:"block w-full rounded-l-md border border-zinc-700 bg-zinc-700 px-3 py-2 text-white placeholder-gray-400 focus:border-amber-500 focus:outline-none focus:ring-amber-500",placeholder:"Add an option",onKeyDown:t=>{t.key==="Enter"&&(t.preventDefault(),w())}}),e.jsx("button",{type:"button",onClick:w,className:"inline-flex items-center rounded-r-md border border-l-0 border-zinc-600 bg-zinc-600 px-3 py-2 font-medium text-white hover:bg-zinc-500",children:e.jsx(_,{size:16})})]}),i.options.length>0?e.jsx("div",{className:"mt-2 space-y-2",children:i.options.map((t,n)=>e.jsxs("div",{className:"flex items-center justify-between rounded bg-zinc-700 px-3 py-2 text-sm",children:[e.jsx("span",{className:"text-white",children:t}),e.jsx("button",{type:"button",onClick:()=>v(n),className:"text-gray-400 hover:text-white",children:e.jsx(O,{size:16})})]},n))}):e.jsx("p",{className:"mt-2 text-xs text-amber-500",children:"Add at least one option"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"isRequired",type:"checkbox",checked:i.isRequired,onChange:t=>r(n=>({...n,isRequired:t.target.checked})),className:"h-4 w-4 rounded border-zinc-600 bg-zinc-700 text-amber-600 focus:ring-amber-600"}),e.jsx("label",{htmlFor:"isRequired",className:"ml-2 text-sm text-gray-300",children:"Required question"})]}),e.jsxs("div",{className:"pt-2 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>s(!1),className:"inline-flex items-center rounded-lg bg-zinc-700 px-3 py-2 text-sm font-medium text-white hover:bg-zinc-600 focus:outline-none",children:"Cancel"}),e.jsx("button",{type:"button",onClick:y,disabled:c||!i.questionText||i.questionType==="multiple_choice"&&i.options.length===0,className:"inline-flex items-center rounded-lg bg-amber-600 px-3 py-2 text-sm font-medium text-white hover:bg-amber-700 focus:outline-none disabled:opacity-50",children:c?e.jsxs(e.Fragment,{children:[e.jsx(C,{size:16,className:"mr-2 animate-spin"}),"Adding..."]}):e.jsxs(e.Fragment,{children:[e.jsx(me,{size:16,className:"mr-2"}),"Add Question"]})})]})]})]}),d?e.jsxs("div",{className:"flex items-center justify-center py-6",children:[e.jsx(C,{size:20,className:"animate-spin text-amber-500 mr-2"}),e.jsx("span",{className:"text-white",children:"Loading questions..."})]}):a.length>0?e.jsx("div",{className:"space-y-3",children:a.map(t=>e.jsx("div",{className:`rounded-lg p-3 ${t.active?"bg-zinc-800":"bg-zinc-800/50"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-sm font-medium text-white",children:t.questionText}),t.isRequired&&e.jsx("span",{className:"ml-2 rounded-full bg-amber-600/30 px-2 py-0.5 text-xs font-medium text-amber-400",children:"Required"}),!t.active&&e.jsx("span",{className:"ml-2 rounded-full bg-zinc-600 px-2 py-0.5 text-xs font-medium text-gray-300",children:"Inactive"})]}),e.jsxs("div",{className:"mt-1 flex items-center text-xs text-gray-400",children:[e.jsx("span",{className:"rounded bg-zinc-700 px-2 py-0.5",children:t.questionType==="rating"?"Star Rating":t.questionType==="text"?"Text Input":"Multiple Choice"}),e.jsx("span",{className:"mx-2",children:"•"}),e.jsxs("span",{children:["Order: ",t.displayOrder]})]}),t.questionType==="multiple_choice"&&t.options.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:t.options.map((n,g)=>e.jsx("span",{className:"rounded bg-zinc-700 px-2 py-0.5 text-xs text-gray-300",children:n},g))})]}),e.jsx("div",{className:"flex space-x-1",children:e.jsx("button",{className:`rounded p-1 text-xs ${t.active?"text-green-500":"text-gray-500"}`,title:t.active?"Active":"Inactive",children:e.jsx("div",{className:`h-2 w-2 rounded-full ${t.active?"bg-green-500":"bg-gray-500"}`})})})]})},t.id))}):e.jsxs("div",{className:"rounded-lg bg-zinc-800 p-6 text-center",children:[e.jsx(xe,{size:24,className:"mx-auto text-gray-500 mb-2"}),e.jsx("p",{className:"text-gray-300",children:"No feedback questions configured"}),e.jsx("p",{className:"mt-1 text-xs text-gray-400",children:"Add questions to gather structured feedback from customers"})]}),e.jsx("div",{className:"mt-6 rounded-lg bg-zinc-800 p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(te,{size:16,className:"mt-0.5 mr-2 text-amber-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white",children:"About Feedback Questions"}),e.jsx("p",{className:"mt-1 text-xs text-gray-400",children:"These questions will be presented to customers after they submit their event rating. Creating structured questions helps you gather consistent feedback across events."})]})]})})]})},Oe=()=>{const{id:a}=ie(),d=ne(),u=le(),[c,m]=b.useState("overview"),[s,i]=b.useState(null),[r,h]=b.useState(""),{data:p,isLoading:w}=oe(a||""),{reviews:v,isLoading:y}=I(a),t=v.filter(n=>s===null||n.rating===s).filter(n=>{var g;return r===""||((g=n.reviewText)==null?void 0:g.toLowerCase().includes(r.toLowerCase()))||n.tags.some(N=>N.toLowerCase().includes(r.toLowerCase()))});return w?e.jsxs("div",{className:"flex h-64 items-center justify-center",children:[e.jsx("div",{className:"mr-3 h-6 w-6 animate-spin rounded-full border-2 border-amber-500 border-t-transparent"}),e.jsx("p",{className:"text-lg text-white",children:"Loading event details..."})]}):p?e.jsxs("div",{className:"space-y-6",children:[e.jsx(ce,{items:u}),e.jsxs("div",{className:"flex flex-col items-start justify-between space-y-4 sm:flex-row sm:items-center sm:space-y-0",children:[e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>d(`/ticketing/${a}`),className:"mb-2 flex items-center text-sm font-medium text-gray-400 hover:text-white",children:[e.jsx(pe,{size:16,className:"mr-1"}),"Back to Event"]}),e.jsxs("h1",{className:"font-playfair text-3xl font-bold tracking-tight text-white",children:[p.title," - Reviews"]}),e.jsxs("p",{className:"text-sm text-gray-400",children:[e.jsx(K,{size:14,className:"inline-block mr-1"}),new Date(p.date).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{className:"inline-flex items-center rounded-lg bg-zinc-800 px-3 py-2 text-sm font-medium text-white hover:bg-zinc-700 focus:outline-none",children:[e.jsx(ae,{size:16,className:"mr-2"}),"Export"]}),e.jsxs("button",{onClick:()=>m("form"),className:"inline-flex items-center rounded-lg bg-amber-600 px-3 py-2 text-sm font-medium text-white hover:bg-amber-700 focus:outline-none",children:[e.jsx(R,{size:16,className:"mr-2"}),"Add Review"]})]})]}),e.jsxs(ue,{value:c,onValueChange:n=>m(n),className:"w-full",children:[e.jsxs(he,{className:"mb-6",children:[e.jsxs(S,{value:"overview",className:"flex items-center",children:[e.jsx(H,{size:14,className:"mr-2"}),"Overview"]}),e.jsxs(S,{value:"reviews",className:"flex items-center",children:[e.jsx(be,{size:14,className:"mr-2"}),"All Reviews"]}),e.jsxs(S,{value:"form",className:"flex items-center",children:[e.jsx(R,{size:14,className:"mr-2"}),"Add Review"]}),e.jsxs(S,{value:"feedback-setup",className:"flex items-center",children:[e.jsx(U,{size:14,className:"mr-2"}),"Questions Setup"]})]}),e.jsx(q,{value:"overview",children:e.jsx(ve,{reviews:v,isLoading:y})}),e.jsx(q,{value:"reviews",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-2 sm:space-y-0",children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-1 text-white",children:[e.jsx("span",{className:"font-medium",children:"Filter:"}),e.jsx("button",{onClick:()=>i(null),className:`rounded-full px-2 py-0.5 text-xs font-medium ${s===null?"bg-amber-600 text-white":"bg-zinc-800 text-gray-300"}`,children:"All"}),[5,4,3,2,1].map(n=>e.jsxs("button",{onClick:()=>i(n===s?null:n),className:`rounded-full px-2 py-0.5 text-xs font-medium ${s===n?"bg-amber-600 text-white":"bg-zinc-800 text-gray-300"}`,children:[n,"★"]},n))]})}),e.jsxs("div",{className:"relative w-full sm:w-auto",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx(re,{size:12,className:"text-gray-400"})}),e.jsx("input",{type:"text",className:"block w-full sm:w-64 rounded-lg border-0 bg-zinc-800 py-1.5 pl-8 pr-3 text-white placeholder-gray-400 focus:ring-2 focus:ring-amber-500 text-xs sm:text-sm",placeholder:"Search reviews...",value:r,onChange:n=>h(n.target.value)})]})]}),e.jsx(je,{reviews:t,isLoading:y,onSelect:n=>console.log("Selected review:",n.id)})]})}),e.jsx(q,{value:"form",children:e.jsx(fe,{eventId:a||"",onSuccess:()=>m("reviews")})}),e.jsx(q,{value:"feedback-setup",children:e.jsx(ye,{})})]})]}):e.jsxs("div",{className:"rounded-xl bg-zinc-900 p-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-white",children:"Event not found"}),e.jsx("p",{className:"mt-2 text-gray-400",children:"The event you're looking for doesn't exist or you don't have permission to view it."}),e.jsx("button",{onClick:()=>d("/ticketing"),className:"mt-4 rounded-lg bg-amber-600 px-4 py-2 text-sm font-medium text-white hover:bg-amber-700",children:"Back to Events"})]})};export{Oe as default};
